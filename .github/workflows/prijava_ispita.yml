name: prijava ispita

on:
  workflow_dispatch:
  schedule:
    - cron: '0 5 30 12 *'   
    - cron: '0 5 2 2 *'    
    - cron: '0 5 7 4 *'    
    - cron: '0 5 8 6 *'     
    - cron: '0 5 13 7 *'    
    - cron: '0 5 4 9 *'     

jobs:
  mail:
    runs-on: ubuntu-latest
    steps:
      - name: Send single-recipient e-mail
        env:
          SMTP_SERVER: smtp.gmail.com
          SMTP_PORT:   587
          BOT_MAIL:   ${{ secrets.BOT_MAIL }}  
          BOT_PASS:   ${{ secrets.BOT_PASS }}
          TO_EMAIL:    ${{ secrets.TO_EMAIL }} 
          SUBJECT:     "SIP prijava ispita"
          BODY_TEXT: |
            Prijavi ispite !!!
            
        shell: python
        run: |
          import os, smtplib
          from email.message import EmailMessage

          msg = EmailMessage()
          msg["From"]    = os.getenv("BOT_MAIL")
          msg["To"]      = os.getenv("TO_EMAIL")
          msg["Subject"] = os.getenv("SUBJECT")
          msg.set_content(os.getenv("BODY_TEXT"))

          with smtplib.SMTP(os.getenv("SMTP_SERVER"), int(os.getenv("SMTP_PORT"))) as smtp:
              smtp.starttls()
              smtp.login(os.getenv("BOT_MAIL"), os.getenv("BOT_PASS"))
              smtp.send_message(msg)

          print("âœ… E-mail sent!")
